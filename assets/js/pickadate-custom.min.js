!function(e){e(document).ready(function(){function t(e,t){var i=a(e);t>0?(endFirstDay=parseInt(i)+parseInt(t),"days"===o&&(endFirstDay-=1)):endFirstDay="nights"===o?parseInt(i)+1:i,0>=i&&(i=!0),endFirstDay<=0&&(endFirstDay=!0),pickerStart.set("min",i,{muted:!0}),pickerEnd.set("min",endFirstDay,{muted:!0})}function a(e){var t=+e;return t}$input=e(".datepicker").pickadate({formatSubmit:"yyyy-mm-dd"}),$inputStart=e(".datepicker_start").pickadate(),$inputEnd=e(".datepicker_end").pickadate(),picker=$input.pickadate("picker"),pickerStart=$inputStart.pickadate("picker"),pickerEnd=$inputEnd.pickadate("picker");var i,r,n=ajax_object.product_type,c=!1,o=ajax_object.calc_mode;if("simple"===n){{var r=ajax_object.first_date,i=ajax_object.min;ajax_object.max}t(r,i)}if("variable"===n){var s=e(".wceb_picker_wrap");s.hide(),e(".price").find(".wceb-price-format").hide(),e("body").on("found_variation",".variations_form",function(a,n){n.is_purchasable&&n.is_in_stock&&n.variation_is_visible&&n.is_bookable?(s.slideDown(200),pickerStart.clear(),pickerEnd.clear(),variationId=n.variation_id,r=ajax_object.first_date[variationId],i=ajax_object.min[variationId],t(r,i),e(".price").find(".wceb-price-format").show()):(s.hide(),e(".price").find(".wceb-price-format").hide())}),e("body").on("reset_image",".variations_form",function(){s.hide()})}ebs_clear_booking_session=function(){if(c){var t={action:"clear_booking_session"};e.post(ajax_object.ajax_url,t,function(e){c=e})}},ebs_get_min_and_max=function(t,i){var c=new Date(t.year,t.month,t.date),o=new Date(t.year,t.month,t.date);if("variable"===n)var s=e(".variations_form").find("input.variation_id").val(),d=parseInt(ajax_object.min[s]),p=parseInt(ajax_object.max[s]);else var d=parseInt(ajax_object.min),p=parseInt(ajax_object.max);var _=ajax_object.calc_mode;"plus"===i?(0==d?"nights"===_&&(d+=1):"days"===_&&(d-=1),0==p&&(p-=1),"days"===_&&(p-=1)):0==p?(c=new Date,0!=d&&(p=d,p-=1),d=1,"nights"===_&&(d-=1,p+=1)):(temp=d,d=p,p=temp,0!=temp&&(p-=1),"days"===_?d-=1:p+=1),"plus"===i?(c.setDate(c.getDate()+d),o.setDate(o.getDate()+p)):(c.setDate(c.getDate()-d),o.setDate(o.getDate()-p));var l=new Date,m=a(r);0!=m&&l.setDate(l.getDate()+m),l>c&&(c=l),0>p&&(o=!1);var u={};return u.min=c,u.max=o,u},getAdditionalCosts=function(){var t=0;return e("form.cart").find(".addon").each(function(){var a=0;e(this).is(".addon-custom-price")?a=e(this).val():e(this).is(".addon-input_multiplier")?(isNaN(e(this).val())||""==e(this).val()?(e(this).val(""),e(this).closest("p").find(".addon-alert").show()):(""!=e(this).val()&&e(this).val(Math.ceil(e(this).val())),e(this).closest("p").find(".addon-alert").hide()),a=e(this).data("price")*e(this).val()):e(this).is(".addon-checkbox, .addon-radio")?e(this).is(":checked")&&(a=e(this).data("price")):e(this).is(".addon-select")?e(this).val()&&(a=e(this).find("option:selected").data("price")):e(this).val()&&(a=e(this).data("price")),a||(a=0),t+=a}),t},ebs_set_price=function(t,a,i,r){product_id="variable"===n?e("input[name=product_id]").val():e("input[name=add-to-cart]").val(),variation_id=e(".variations_form").find("input.variation_id").val();{var o=getAdditionalCosts(),s={action:"add_new_price",product_id:product_id,variation_id:variation_id,start:i,end:r,start_format:t,end_format:a,additional_cost:o};window.location.toString()}e("form.cart").fadeTo("400","0.6").block({message:null,overlayCSS:{background:"transparent",backgroundSize:"16px 16px",opacity:.6}}),e.post(ajax_object.ajax_url,s,function(t){e(".woocommerce-error, .woocommerce-message").remove(),fragments=t.fragments,errors=t.errors,errors&&e.each(errors,function(t,a){e(t).replaceWith(a)}),fragments&&e.each(fragments,function(t,a){e(t).replaceWith(a)}),e("form.cart").trigger("update_price",[s,t]),e("form.cart").stop(!0).css("opacity","1").unblock(),c=fragments.session})},pickerStart.on({render:function(){pickerStart.$root.find(".picker__header").prepend('<div class="picker__title">'+ajax_object.start_text+"</div>")},set:function(e){if("undefined"!=typeof e.clear&&null==e.clear){var t=a(r)+parseInt(i);0===t&&(t="nights"===o?1:!0),"nights"===o&&0===i&&1!=t&&(t+=1),"days"===o&&i>0&&1!=t&&(t-=1),pickerEnd.set({disable:!1,min:t,max:!1,highlight:new Date},{muted:!0}),startPick=void 0,ebs_clear_booking_session()}if(!e.select||"undefined"==typeof e.select)return!1;startPick=e.select,startDate=pickerStart.get("select","yyyy-mm-dd");var n=pickerStart.get("select");startDateDisplay=pickerStart.get("select","dd mmmm yyyy"),"object"==typeof startPick&&(startPick=e.select.pick);var c=ebs_get_min_and_max(n,"plus"),s=c.min,d=c.max;pickerEnd.set({min:s,max:d,highlight:s},{muted:!0}),"undefined"!=typeof startPick&&"undefined"!=typeof endPick&&ebs_set_price(startDate,endDate,startDateDisplay,endDateDisplay)},close:function(){e(document.activeElement).blur(),"undefined"!=typeof startPick&&"undefined"==typeof endPick&&setTimeout(function(){pickerEnd.open()},250)}}),pickerEnd.on({render:function(){pickerEnd.$root.find(".picker__header").prepend('<div class="picker__title">'+ajax_object.end_text+"</div>")},set:function(e){if("undefined"!=typeof e.clear&&null==e.clear){var t=a(r);0===t&&(t=!0),pickerStart.set({disable:!1,min:t,max:!1,highlight:new Date},{muted:!0}),endPick=void 0,ebs_clear_booking_session()}if(!e.select||"undefined"==typeof e.select)return!1;endPick=e.select,endDate=pickerEnd.get("select","yyyy-mm-dd");var i=pickerEnd.get("select");endDateDisplay=pickerEnd.get("select","dd mmmm yyyy"),"object"==typeof endPick&&(endPick=e.select.pick);var n=ebs_get_min_and_max(i,"minus"),c=n.min,o=n.max;pickerStart.set({min:c,max:o,highlight:c},{muted:!0}),"undefined"!=typeof startPick&&"undefined"!=typeof endPick&&ebs_set_price(startDate,endDate,startDateDisplay,endDateDisplay)},close:function(){e(document.activeElement).blur()}}),e("body").on("updated_addons",function(){if("variable"===n)var t=e(".variations_form").find("input.variation_id").val(),a=parseInt(ajax_object.product_price[t]);else var a=parseInt(ajax_object.product_price);var i=getAdditionalCosts(),r=parseFloat(i+a);i>0&&(pickerStart.clear(),pickerEnd.clear());var c=accounting.formatMoney(r,{symbol:ajax_object.currency_format_symbol,decimal:ajax_object.currency_format_decimal_sep,thousand:ajax_object.currency_format_thousand_sep,precision:ajax_object.currency_format_num_decimals,format:ajax_object.currency_format});"variable"===n?e(".single_variation .price .amount").html(c):e("p.booking_price .price .amount").html(c)})})}(jQuery);