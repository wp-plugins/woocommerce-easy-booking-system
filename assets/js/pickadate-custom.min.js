!function(e){e(document).ready(function(){if(productType=ajax_object.product_type,"variable"===productType){var t=e(".wceb_picker_wrap");t.hide(),e("body").on("found_variation",".variations_form",function(e,a){a.is_purchasable&&a.is_in_stock&&a.variation_is_visible?t.slideDown(200):t.hide()}),e("body").on("reset_image",".variations_form",function(){t.hide()})}firstDay=+ajax_object.first_date,0==firstDay&&(firstDay=!0),$input=e(".datepicker").pickadate({min:firstDay,close:"",formatSubmit:"yyyy-mm-dd"}),$inputStart=e(".datepicker_start").pickadate(),$inputEnd=e(".datepicker_end").pickadate(),picker=$input.pickadate("picker"),pickerStart=$inputStart.pickadate("picker"),pickerEnd=$inputEnd.pickadate("picker"),pickerStart.on({set:function(e){if("undefined"!=typeof e.clear&&null==e.clear&&(pickerEnd.set({disable:!1,max:!1,highlight:new Date},{muted:!0}),startPick=void 0,ebs_clear_booking_session()),!e.select||"undefined"==typeof e.select)return!1;startPick=e.select,startDate=pickerStart.get("select","yyyy-mm-dd");var t=pickerStart.get("select");startDateDisplay=pickerStart.get("select","dd mmmm yyyy"),"object"==typeof startPick&&(startPick=e.select.pick);var a=ebs_get_min_and_max(t,"plus"),i=a.min,r=a.max;pickerEnd.set({disable:!1,max:!1,highlight:i},{muted:!0}),"days"==ajax_object.calc_mode?pickerEnd.set({disable:[{from:!0,to:[t.year,t.month,t.date-1]},{from:[t.year,t.month,t.date],to:i}],max:r},{muted:!0}):pickerEnd.set({disable:[{from:!0,to:[t.year,t.month,t.date]},{from:[t.year,t.month,t.date],to:i}],max:r},{muted:!0}),"undefined"!=typeof startPick&&"undefined"!=typeof endPick&&ebs_set_price(startPick,endPick,startDate,endDate,startDateDisplay,endDateDisplay)}}),pickerEnd.on({set:function(e){if("undefined"!=typeof e.clear&&null==e.clear&&(pickerStart.set({disable:!1,max:!1,highlight:new Date},{muted:!0}),endPick=void 0,ebs_clear_booking_session()),!e.select||"undefined"==typeof e.select)return!1;endPick=e.select,endDate=pickerEnd.get("select","yyyy-mm-dd");var t=pickerEnd.get("select");endDateDisplay=pickerEnd.get("select","dd mmmm yyyy"),"object"==typeof endPick&&(endPick=e.select.pick);var a=ebs_get_min_and_max(t,"minus"),i=a.min,r=a.max;pickerStart.set({disable:!1,highlight:i},{muted:!0}),"days"==ajax_object.calc_mode?pickerStart.set({disable:[{from:!0,to:i}],max:r},{muted:!0}):pickerStart.set({disable:[{from:!0,to:i}],max:r},{muted:!0}),"undefined"!=typeof startPick&&"undefined"!=typeof endPick&&ebs_set_price(startPick,endPick,startDate,endDate,startDateDisplay,endDateDisplay)}}),ebs_clear_booking_session=function(){var t={action:"clear_booking_session"};e.post(ajax_object.ajax_url,t)},ebs_get_min_and_max=function(e,t){var a=new Date(e.year,e.month,e.date),i=new Date(e.year,e.month,e.date),r=parseInt(ajax_object.min),n=parseInt(ajax_object.max),c=ajax_object.calc_mode;"plus"==t?(0==r?r-=1:(r-=2,"nights"==c&&(r+=1)),0==n&&(n-=1),"days"==c&&(n-=1)):0==n?(a=new Date,0!=r&&(n=r,n-=1),r=1,"nights"==c&&(n+=1)):(temp=r,r=n,n=temp,0!=temp&&(n-=1),"nights"==c&&(r+=1,n+=1)),"plus"==t?(a.setDate(a.getDate()+r),i.setDate(i.getDate()+n)):(a.setDate(a.getDate()-r),i.setDate(i.getDate()-n)),0>n&&(i=!1);var o={};return o.min=a,o.max=i,o},ebs_set_price=function(t,a,i,r,n,c){product_id="variable"===productType?e("input[name=product_id]").val():e("input[name=add-to-cart]").val(),variation_id=e(".variations_form").find("input.variation_id").val();var o=parseInt((a-t)/864e5);0==o&&(o=1);{var s={action:"add_new_price",product_id:product_id,variation_id:variation_id,days:o,start:n,end:c,start_format:i,end_format:r};window.location.toString()}e("form.cart").fadeTo("400","0.6").block({message:null,overlayCSS:{background:"transparent",backgroundSize:"16px 16px",opacity:.6}}),e.post(ajax_object.ajax_url,s,function(t){e(".woocommerce-error, .woocommerce-message").remove(),fragments=t.fragments,errors=t.errors,errors&&e.each(errors,function(t,a){e(t).replaceWith(a)}),fragments&&e.each(fragments,function(t,a){e(t).replaceWith(a)}),e("form.cart").stop(!0).css("opacity","1").unblock()})},e(".variations_form").on("change",".variations select",function(){pickerStart.clear(),pickerEnd.clear()})})}(jQuery);